<ng-container *ngIf="vm$ | async; let vm">
  <div class="flex flex-row items-center bg-base-300">
    <label class="join ml-2">
      <span class="join-item btn btn-sm">Amount</span>
      <input
        data-cy="amount"
        type="number"
        min="1"
        [ngModel]="vm.amount"
        (ngModelChange)="amount = $event"
        class="join-item input input-bordered input-sm pr-0 w-20"
      />
    </label>
    <div class="flex-1"></div>
    <ul class="flex flex-row">
      <li>
        <button class="btn btn-ghost btn-square" [cdkMenuTriggerFor]="tplChances" [tooltip]="'Edit Bonus Chance'">
          <nwb-icon [icon]="iconOptions" class="w-4 h-4" />
        </button>
      </li>
      <li
        [tooltip]="'Toggle net/gross mode'"
        (click)="toggleQuantityMode()"
        [class.text-primary]="vm.amountMode === 'gross'"
      >
        <button class="btn btn-ghost btn-square">
          <nwb-icon [icon]="iconMode" class="w-4 h-4"/>
        </button>
      </li>
      <li [tooltip]="'Open price importer'">
        <nwb-price-importer-button class="btn btn-ghost btn-square" />
      </li>
    </ul>
  </div>
  <div data-cy="body" class="p-4 pt-0" *ngIf="vm.recipe">
    <nwb-crafting-step [step]="vm.tree" [amount]="vm.amount" [amountMode]="vm.amountMode"></nwb-crafting-step>
    <nwb-crafting-summary
      [step]="vm.tree"
      [amount]="vm.amount"
      [amountMode]="vm.amountMode"
      class="mt-2"
    ></nwb-crafting-summary>
    <a [nwGamingToolsLink]="vm.recipe" class="btn btn-block btn-ghost gap-2">
      <img [nwImage]="'assets/gaming-tools-logo.svg'" class="w-14" width="1020" height="600" />
      Calculator
    </a>
  </div>

  <ng-template #tplChances>
    <nwb-crafting-chance-menu cdkMenu class="menu menu-compact border border-base-200 bg-base-300 rounded-md" />
  </ng-template>
</ng-container>
