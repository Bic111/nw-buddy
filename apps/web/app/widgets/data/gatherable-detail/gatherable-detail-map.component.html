@if (vm(); as vm) {
  <nwb-land-map class="aspect-square relative" [map]="mapId()" [landmarks]="vm.landmarks">
    <div class="w-auto input-group absolute top-2 right-2">
      <select class="select select-sm max-w-[200px]" [ngModel]="mapId()" (ngModelChange)="selectedMapId.set($event)">
        @for (value of mapIds(); track $index) {
          <option [value]="value">{{ value }}</option>
        }
      </select>
      <button class="btn btn-square btn-sm" (click)="toggleFullscreen()">
        <nwb-icon [icon]="iconExpand" class="w-4 h-4" />
      </button>
    </div>

    <div class="absolute bottom-0 w-full p-1 flex flex-row justify-center items-center gap-1 bg-opacity-50 bg-black">
      @for (row of availableSizes(); track $index) {
        <span
          class="badge cursor-pointer"
          [class.badge-outline]="row.disabled"
          [class.line-through]="row.disabled"
          [class.opacity-50]="row.disabled"
          [style.background-color]="row.color"
          [tooltip]="row.value"
          (click)="toggleSize(row.value)"
        >
          {{ row.count }}
        </span>
      }
      @if (vm.isLimited) {
        <button
          class="btn btn-xs btn-error gap-1"
          [tooltip]="tipLimit"
          [tooltipClass]="'bg-transparent border-0'"
          [cdkMenuTriggerFor]="limitMenu"
        >
          <nwb-icon [icon]="iconWarning" class="w-4 h-4" />
          <span>Limit</span>
        </button>
        <ng-template #tipLimit>
          <div class="alert alert-error">
            <nwb-icon [icon]="iconWarning" class="w-4 h-4" />
            <div>Showing {{ vm.shown | number }} of {{ vm.total | number }} items. Click to change limit.</div>
          </div>
        </ng-template>
        <ng-template #limitMenu>
          <div class="bg-base-200 border border-base-100 rounded-md shadow-lg">
            <ul class="menu menu-compact menu-vertical" cdkMenu>
              @for (value of availableLimits; track $index) {
                <li class="text-shadow-sm shadow-black " cdkMenuItem>
                  <a
                    (click)="limit.set(value)"
                    [class.text-success]="!!value && (value < 10000)"
                    [class.text-warning]="value >= 10000 && value < 20000"
                    [class.text-error]="!value || (value >= 20000)"
                  >
                    <span>{{ value ? (value | number) : 'Unlimited' }}</span>
                    @if (!value) {
                      <span class="text-xs"> (Please don't)</span>
                    }
                  </a>
                </li>
              }
            </ul>
          </div>
        </ng-template>
      }
    </div>
  </nwb-land-map>
}
