<ion-header class="bg-base-300">
  <div class="flex flex-col-reverse md:flex-row">
    <ul class="flex flex-row flex-nowrap flex-1 w-full overflow-x-auto scrollbar-hide gap-1">
      <li>
        <button
          [nwbDataCateogryMenu]
          [category]="category$ | async"
          [showCounter]="true"
          [defaultRoute]="defaultRoute"
          [defaultTitle]="title"
          [routePrefix]="'..'"
          class="btn btn-ghost normal-case text-left"
        ></button>
      </li>
      <span class="flex-1"></span>
      <li>
        <button class="btn btn-square btn-ghost" [nwbScreenshotBtn]></button>
      </li>
      <li>
        <button class="btn btn-square btn-ghost" [nwbDataViewPin]></button>
      </li>
      <li *ngIf="service.canToggleMode$()">
        <button class="btn btn-square btn-ghost" [nwbDataViewToggle]></button>
      </li>
      <li class="hidden 2xl:flex">
        <button class="btn btn-square btn-ghost" (click)="isFuncOpen = !isFuncOpen">
          <nwb-icon [icon]="iconFunc"></nwb-icon>
        </button>
      </li>
      <li>
        <button class="btn btn-square btn-ghost" [nwbDataViewOptionsMenu]="tplContextPanel"></button>
        <ng-template #tplContextPanel>
          <ul class="menu menu-compact">
            <li class="menu-title">
              <span>Perk Variables</span>
            </li>
            <div class="form-control w-full px-3 py-1">
              <label class="label">
                <span class="label-text">Char Level: {{ ctx.charLevel$() }}</span>
              </label>
              <input
                type="range"
                min="0"
                max="60"
                [ngModel]="ctx.charLevel$()"
                (ngModelChange)="ctx.patchState({ charLevel: $event })"
                class="range range-xs"
              />
            </div>
            <div class="form-control w-full px-3 py-1">
              <label class="label">
                <span class="label-text">Gear Score: {{ ctx.gearScore$() }}</span>
              </label>
              <input
                type="range"
                min="0"
                max="700"
                [ngModel]="ctx.gearScore$()"
                (ngModelChange)="ctx.patchState({ gearScore: $event })"
                class="range range-xs"
              />
            </div>
            <!-- <div class="form-control w-full">
              <label class="label cursor-pointer">
                <span class="label-text">GS Bonus</span>
                <input type="checkbox" checked="checked" [(ngModel)]="ctx.gsBonus" class="checkbox checkbox-xs" />
              </label>
            </div> -->
          </ul>

          <div class="divider"></div>
        </ng-template>
      </li>
    </ul>

    <div class="flex-none p-2 w-full md:max-w-[256px]">
      <nwb-quicksearch-input [autofocus]="true" [placeholder]="'Quickfilter'"></nwb-quicksearch-input>
    </div>
  </div>
</ion-header>
<div class="flex-1 flex flex-row overflow-hidden">
  <ng-container *ngIf="service.isGridActive$()">
    <nwb-virtual-grid
      [enableQuickfilter]="true"
      [data]="service.categoryItems$ | async"
      [options]="service.virtualOptions"
      [identifyBy]="service.entityIdGetter"
      [selectionRouteParam]="selectionParam"
    ></nwb-virtual-grid>
  </ng-container>
  <ng-container *ngIf="service.isTableActive$()">
    <nwb-table-grid
      (ready$)="service.onTableReady($event)"
      [enableQuickfilter]="true"
      [data]="service.categoryItems$ | async"
      [options]="service.tableGridOptions"
      [identifyBy]="service.entityIdGetter"
      [persistKey]="persistKey"
      [filterQueryParam]="filterParam"
      [selectionRouteParam]="selectionParam"
    ></nwb-table-grid>
  </ng-container>
  <div class="w-[600px] hidden 2xl:block p-2 overflow-auto" *ngIf="isFuncOpen">
    <nwb-table-grid-expression-panel [grid]="service.agGrid$ | async"></nwb-table-grid-expression-panel>
  </div>
  <router-outlet></router-outlet>
</div>
