<div class="flex-nonw"></div>
<div class="flex-1 p-4 overflow-auto">
  <div class="max-w-5xl mx-auto flex flex-col gap-4">
    <nwb-attributes-editor
      [freeMode]="true"
      [assigned]="attrSums()"
      (assignedChanged)="patchState({ attrSums: $event })"
    />
    <div class="grid gap-4 grid-cols-fill-sm">

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Attribute Scaling</span>
        </label>

        <div
          type="number"
          class="input input-bordered w-full flex items-center"

        > {{ attrScale() | number }}</div>

      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Player Level</span>
          <span class="label-text">Level Scaling</span>
        </label>

        <label class="input-group">
          <input
            type="number"
            class="input input-bordered w-full"
            [ngModel]="playerLevel()"
            (ngModelChange)="patchState({ playerLevel: $event })"
          />
          <span>{{ playerLevelFactor() | number }}</span>
        </label>
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Weapon Gear Score</span>
          <span class="label-text">Factor From GS</span>
        </label>
        <label class="input-group">
          <input
            type="number"
            class="input input-bordered w-full"
            [ngModel]="weaponGearScore()"
            (ngModelChange)="patchState({ weaponGearScore: $event })"
          />
          <span>{{ weaponGearScoreFactor() | number }}</span>
        </label>
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Weapon</span>
        </label>
        <select
          class="input input-bordered w-full"
          [ngModel]="weapon()"
          (ngModelChange)="patchState({ weapon: $event })"
        >
          @for (option of weaponTypes; track $index) {
            <option [value]="option.value">{{ option.label | nwText }}</option>
          }
        </select>
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Base Damage</span>
        </label>
        <input
          type="number"
          [step]="0.1"
          class="input input-bordered w-full"
          [ngModel]="baseDamage()"
          (ngModelChange)="patchState({ baseDamage: $event })"
        />
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Crit Damage</span>
        </label>
        <input
          type="number"
          [step]="0.1"
          [min]="0"
          class="input input-bordered w-full"
          [ngModel]="critDamage()"
          (ngModelChange)="patchState({ critDamage: $event })"
        />
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Attack</span>
        </label>
        <select
          class="input input-bordered w-full"
          [ngModel]="attack()"
          (ngModelChange)="patchState({ attack: $event })"
        >
          @for (option of attackTypes(); track $index) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Damage Coefficient</span>
        </label>
        <input
          type="number"
          [step]="0.1"
          class="input input-bordered w-full"
          [ngModel]="damageCoefficient()"
          (ngModelChange)="patchState({ damageCoefficient: $event })"
        />
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Ammo Modifier</span>
        </label>
        <input
          type="number"
          [step]="0.1"
          class="input input-bordered w-full"
          [ngModel]="ammoModifier()"
          (ngModelChange)="patchState({ ammoModifier: $event })"
        />
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Base Damage Modifier</span>
        </label>
        <div class="input-group">
          <input
            type="number"
            [step]="0.1"
            class="input input-bordered w-full"
            [ngModel]="baseDamageMods()"
            (ngModelChange)="patchState({ baseDamageMods: $event })"
          />
          <span>{{ baseDamageMods() | percent }}</span>
        </div>
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Crit Modifier</span>
        </label>
        <div class="input-group">
          <input
            type="number"
            [step]="0.1"
            class="input input-bordered w-full"
            [ngModel]="critMods()"
            (ngModelChange)="patchState({ critMods: $event })"
          />
          <span>{{ critModsSum() | percent }}</span>
        </div>
      </div>

      <div class="form-control w-full">
        <label class="label">
          <span class="label-text">Empower Modifier</span>
        </label>
        <div class="input-group">
          <input
            type="number"
            [step]="0.1"
            class="input input-bordered w-full"
            [ngModel]="empowerMods()"
            (ngModelChange)="patchState({ empowerMods: $event })"
          />
          <span>{{ empowerMods() | percent }}</span>
        </div>
      </div>
    </div>
    <div class="flex items-center justify-center">
      <div class="stats shadow">
        <div class="stat">
          <div class="stat-title">Tooltip</div>
          <div class="stat-value">{{ dmgTooltip() | number: '1.2-2' }}</div>
          <div class="stat-desc">Baseline 100%</div>
        </div>
        <div class="stat">
          <div class="stat-title">Standard</div>
          <div class="stat-value">{{ dmgStandard() | number: '1.2-2' }}</div>
          <div class="stat-desc">
            {{ dmgStandard() / dmgTooltip() | percent }}
          </div>
        </div>
        <div class="stat">
          <div class="stat-title">Crit</div>
          <div class="stat-value">{{ dmgCrit() | number: '1.2-2' }}</div>
          <div class="stat-desc">
            {{ dmgCrit() / dmgTooltip() | percent }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
