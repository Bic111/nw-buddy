<div>
  <h3 class="text-lg uppercase relative text-center font-serif text-nw-description nw-bg-title bg-bottom">
    Attacker Stats
  </h3>
  <div>
    <div class="grid gap-4 grid-auto-fit-80">
      <nwb-ctrl-offender />
      <nwb-ctrl-weapon />
      <nwb-ctrl-damage-conversion />

      <div class="form-control">
        <label class="label">
          <span class="label-text"> Attack </span>
          <span class="label-text"> Coef </span>
        </label>
        <span class="join">
          <select
            class="join-item input input-sm input-bordered w-full"
            [(ngModel)]="offenderDamageRow.value"
            [disabled]="!attackOptions()?.length"
          >
            @for (option of attackOptions(); track $index) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
          <input
            type="number"
            class="join-item input input-sm input-bordered w-full text-right"
            [min]="0"
            [max]="10"
            [step]="1"
            [(ngModel)]="offenderDamageCoef.value"
          />
        </span>
      </div>

      <nwb-ctrl-stack-input [(ngModel)]="offenderArmorPenetration.value">
        <span slot="label">Armor penetration</span>
      </nwb-ctrl-stack-input>
    </div>

    <div class="fomr-control">
      <label class="label">
        <span class="label-text">Modifiers</span>
      </label>
      <div class="grid gap-x-4 gap-y-1 grid-auto-fit-80">
        <nwb-ctrl-stack-input [(ngModel)]="offenderModPvP.value" class="col-start-1" [labelHidden]="true" [step]="0.1">
          <span slot="start" class="join-item btn btn-sm w-40"> PvP Balance </span>
        </nwb-ctrl-stack-input>
        <nwb-ctrl-stack-input [(ngModel)]="offenderModAmmo.value" [labelHidden]="true" [step]="0.1">
          <span slot="start" class="join-item btn btn-sm w-40"> Ammo </span>
        </nwb-ctrl-stack-input>
        <nwb-ctrl-stack-input [(ngModel)]="offenderModCrit.value" [labelHidden]="true" [step]="0.1">
          <span slot="start" class="join-item btn btn-sm w-40"> Crit Damage </span>
        </nwb-ctrl-stack-input>

        <div>
          <nwb-ctrl-stack-input [(ngModel)]="offenderModBase.value" [labelHidden]="true" [step]="0.1">
            <span slot="start" class="join-item btn btn-sm w-40">
              <img [nwImage]="store.offenderWeaponDamageTypeIcon()" class="w-5 h-5" />
              Base Damage
            </span>
          </nwb-ctrl-stack-input>

          @if (store.offenderConvertIsActive()) {
            <nwb-ctrl-stack-input
              [(ngModel)]="offenderModBaseConv.value"
              [labelHidden]="true"
              class="mt-1"
              [step]="0.1"
            >
              <span slot="start" class="join-item btn btn-sm w-40 btn-secondary">
                <img [nwImage]="store.offenderConvertDamageTypeIcon()" class="w-5 h-5" />
                Base Damage
              </span>
            </nwb-ctrl-stack-input>
          }
        </div>

        <div>
          <nwb-ctrl-stack-input [(ngModel)]="offenderModDMG.value" [labelHidden]="true" [step]="0.1">
            <span slot="start" class="join-item btn btn-sm w-40">
              <img [nwImage]="store.offenderWeaponDamageTypeIcon()" class="w-5 h-5" />
              DMG
            </span>
          </nwb-ctrl-stack-input>
          @if (store.offenderConvertIsActive()) {
            <nwb-ctrl-stack-input [(ngModel)]="offenderModDMGConv.value" [labelHidden]="true" [step]="0.1" class="mt-1">
              <span slot="start" class="join-item btn btn-sm w-40 btn-secondary">
                <img [nwImage]="store.offenderConvertDamageTypeIcon()" class="w-5 h-5" />
                DMG
              </span>
            </nwb-ctrl-stack-input>
          }
        </div>
      </div>
    </div>
  </div>
</div>

<div>
  <h3 class="text-lg uppercase relative text-center font-serif text-nw-description nw-bg-title bg-bottom">
    Defender Stats
  </h3>
  <div class="flex flex-col gap-4">
    <div class="grid gap-x-4 gap-y-1 grid-auto-fit-80">
      <nwb-ctrl-defender />

      <div>
        <nwb-ctrl-stack-input [(ngModel)]="defenderPhysicalArmor.value" [step]="0.1">
          <span slot="label"> Physical Armor </span>
          <span slot="end-label"> Rating {{ store.defenderPhysicalArmor() | number: '0.1-1' }} </span>
          <span slot="start" class="join-item btn btn-sm w-40"> Armor </span>
        </nwb-ctrl-stack-input>
        <nwb-ctrl-stack-input
          [(ngModel)]="defenderPhysicalArmorFortify.value"
          [step]="0.1"
          [labelHidden]="true"
          class="mt-1"
        >
          <span slot="start" class="join-item btn btn-sm w-40"> Armor Fortify </span>
        </nwb-ctrl-stack-input>
        <nwb-ctrl-stack-input
          [(ngModel)]="defenderPhysicalArmorAdd.value"
          [step]="0.1"
          [labelHidden]="true"
          class="mt-1"
        >
          <span slot="start" class="join-item btn btn-sm w-40"> Shield </span>
        </nwb-ctrl-stack-input>
      </div>

      <div>
        <nwb-ctrl-stack-input [(ngModel)]="defenderElementalArmor.value" [step]="0.1">
          <span slot="label"> Elemental Armor </span>
          <span slot="end-label"> Rating {{ store.defenderElementalArmor() | number: '0.1-1' }} </span>
          <span slot="start" class="join-item btn btn-sm w-40"> Armor </span>
        </nwb-ctrl-stack-input>
        <nwb-ctrl-stack-input
          [(ngModel)]="defenderElementalArmorFortify.value"
          [labelHidden]="true"
          [step]="0.1"
          class="mt-1"
        >
          <span slot="start" class="join-item btn btn-sm w-40"> Armor Fortify </span>
        </nwb-ctrl-stack-input>
        <nwb-ctrl-stack-input
          [(ngModel)]="defenderElementalArmorAdd.value"
          [labelHidden]="true"
          [step]="0.1"
          class="mt-1"
        >
          <span slot="start" class="join-item btn btn-sm w-40"> Shield </span>
        </nwb-ctrl-stack-input>
      </div>
    </div>

    <div class="fomr-control">
      <label class="label">
        <span class="label-text">Modifiers</span>
      </label>
      <div class="grid gap-x-4 gap-y-1 grid-auto-fit-80">
        <nwb-ctrl-stack-input [(ngModel)]="defenderModCritReduction.value" [labelHidden]="true" [min]="0" [step]="0.1">
          <span slot="start" class="join-item btn btn-sm w-40"> Cirt Reduction </span>
        </nwb-ctrl-stack-input>
        <div>
          <nwb-ctrl-stack-input
            [(ngModel)]="defenderModBaseReduction.value"
            [labelHidden]="true"
            [min]="0"
            [step]="0.1"
          >
            <span slot="start" class="join-item btn btn-sm w-40">
              <img [nwImage]="store.offenderWeaponDamageTypeIcon()" class="w-5 h-5" />
              Base Reduction
            </span>
          </nwb-ctrl-stack-input>
          @if (store.offenderConvertIsActive()) {
            <nwb-ctrl-stack-input
              [(ngModel)]="defenderModBaseReductionConv.value"
              [labelHidden]="true"
              [min]="0"
              [step]="0.1"
              class="mt-1"
            >
              <span slot="start" class="join-item btn btn-sm w-40 btn-secondary">
                <img [nwImage]="store.offenderConvertDamageTypeIcon()" class="w-5 h-5" />
                Base Reduction
              </span>
            </nwb-ctrl-stack-input>
          }
        </div>


        <div>
          <nwb-ctrl-stack-input [(ngModel)]="defenderModABS.value" [labelHidden]="true" [step]="0.1">
            <span slot="start" class="join-item btn btn-sm w-40">
              <img [nwImage]="store.offenderWeaponDamageTypeIcon()" class="w-5 h-5" />
              ABS
            </span>
          </nwb-ctrl-stack-input>
          @if (store.offenderConvertIsActive()) {
            <nwb-ctrl-stack-input [(ngModel)]="defenderModABSConv.value" [labelHidden]="true" [step]="0.1" class="mt-1">
              <span slot="start" class="join-item btn btn-sm w-40 btn-secondary">
                <img [nwImage]="store.offenderConvertDamageTypeIcon()" class="w-5 h-5" />
                ABS
              </span>
            </nwb-ctrl-stack-input>
          }
        </div>

        <div>
          <nwb-ctrl-stack-input [(ngModel)]="defenderModWKN.value" [labelHidden]="true" [step]="0.1">
            <span slot="start" class="join-item btn btn-sm w-40">
              <img [nwImage]="store.offenderWeaponDamageTypeIcon()" class="w-5 h-5" />
              WKN
            </span>
          </nwb-ctrl-stack-input>
          @if (store.offenderConvertIsActive()) {
            <nwb-ctrl-stack-input [(ngModel)]="defenderModWKNConv.value" [labelHidden]="true" [step]="0.1" class="mt-1">
              <span slot="start" class="join-item btn btn-sm w-40 btn-secondary">
                <img [nwImage]="store.offenderConvertDamageTypeIcon()" class="w-5 h-5" />
                WKN
              </span>
            </nwb-ctrl-stack-input>
          }
        </div>
      </div>
    </div>
  </div>
</div>

<div>
  <h3 class="text-lg uppercase relative text-center font-serif text-nw-description nw-bg-title bg-bottom">Output</h3>

  <nwb-damage-output />
</div>
